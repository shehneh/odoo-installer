<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±ÛŒ | OdooMaster</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/components.css">
    <script>
        // Apply theme immediately (dashboard styles + main.css variables rely on body.light-theme)
        if (localStorage.getItem('theme') === 'light') {
            document.documentElement.classList.add('light-theme');
        }
    </script>
</head>
<body class="dashboard-page">
    <script>
        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
        }
    </script>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="index.html" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-cube"></i>
                </div>
                <span class="logo-text">Odoo<strong>Master</strong></span>
            </a>
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <span class="nav-section-title" data-i18n="dashboard.mainMenu">Ù…Ù†Ùˆ Ø§ØµÙ„ÛŒ</span>
                <a href="dashboard.html" class="nav-item active">
                    <i class="fas fa-home"></i>
                    <span data-i18n="dashboard.dashboard">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
                </a>
                <a href="#licenses" class="nav-item">
                    <i class="fas fa-key"></i>
                    <span data-i18n="nav.licenses">Ù„Ø§ÛŒØ³Ù†Ø³â€ŒÙ‡Ø§</span>
                    <span class="nav-badge">Û²</span>
                </a>
                <a href="#downloads" class="nav-item">
                    <i class="fas fa-download"></i>
                    <span data-i18n="nav.downloads">Ø¯Ø§Ù†Ù„ÙˆØ¯Ù‡Ø§</span>
                </a>
                <a href="#" class="nav-item disabled-link" aria-disabled="true" tabindex="-1" title="Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯">
                    <i class="fas fa-headset"></i>
                    <span data-i18n="nav.support">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</span>
                </a>
            </div>

            <div class="nav-section">
                <span class="nav-section-title" data-i18n="dashboard.financial">Ù…Ø§Ù„ÛŒ</span>
                <a href="#" class="nav-item disabled-link" aria-disabled="true" tabindex="-1" title="Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯">
                    <i class="fas fa-file-invoice"></i>
                    <span data-i18n="dashboard.invoices">ÙØ§Ú©ØªÙˆØ±Ù‡Ø§</span>
                </a>
                <a href="#" class="nav-item disabled-link" aria-disabled="true" tabindex="-1" title="Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯">
                    <i class="fas fa-wallet"></i>
                    <span data-i18n="dashboard.wallet">Ú©ÛŒÙ Ù¾ÙˆÙ„</span>
                </a>
            </div>

            <div class="nav-section">
                <span class="nav-section-title" data-i18n="dashboard.account">Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</span>
                <a href="#" class="nav-item disabled-link" aria-disabled="true" tabindex="-1" title="Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯">
                    <i class="fas fa-user"></i>
                    <span data-i18n="dashboard.profile">Ù¾Ø±ÙˆÙØ§ÛŒÙ„</span>
                </a>
                <a href="#" class="nav-item disabled-link" aria-disabled="true" tabindex="-1" title="Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯">
                    <i class="fas fa-cog"></i>
                    <span data-i18n="dashboard.settings">ØªÙ†Ø¸ÛŒÙ…Ø§Øª</span>
                </a>
            </div>

            <!-- Admin Section (Visible only for admins) -->
            <div class="nav-section" id="adminNavSection" style="display: none;">
                <span class="nav-section-title" data-i18n="dashboard.management">Ù…Ø¯ÛŒØ±ÛŒØª</span>
                <a href="#admin" class="nav-item admin-link" id="adminNavLink">
                    <i class="fas fa-shield-alt"></i>
                    <span data-i18n="dashboard.adminPanel">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</span>
                </a>
            </div>
        </nav>

        <div class="sidebar-footer">
            <div class="user-card">
                <div class="user-avatar">
                    <img src="https://ui-avatars.com/api/?name=Ú©Ø§Ø±Ø¨Ø±+ØªØ³Øª&background=714B67&color=fff" alt="User">
                    <span class="status-dot online"></span>
                </div>
                <div class="user-info">
                    <strong>Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª</strong>
                    <span>Ù¾Ù„Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</span>
                </div>
                <button class="logout-btn" title="Ø®Ø±ÙˆØ¬">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="topbar">
            <div class="topbar-right">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" data-i18n-placeholder="dashboard.search" placeholder="Search...">
                </div>
            </div>
            <div class="topbar-left">
                <div class="lang-switcher-topbar" id="langSwitcherTopbar">
                    <!-- Language switcher will be inserted here by JS -->
                </div>
                <button class="topbar-btn" id="notifBtn">
                    <i class="fas fa-bell"></i>
                    <span class="notif-badge">3</span>
                </button>
                <button class="topbar-btn" id="themeBtn" title="Toggle Theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Welcome Banner -->
            <div class="welcome-banner glass">
                <div class="welcome-content">
                    <h1><span data-i18n="dashboard.hello">Ø³Ù„Ø§Ù…ØŒ</span> <span class="gradient-text" id="userName">Ú©Ø§Ø±Ø¨Ø± Ø¹Ø²ÛŒØ²</span> ğŸ‘‹</h1>
                    <p data-i18n="dashboard.welcomeText">Welcome! Use your dashboard to manage licenses and download the installer.</p>
                </div>
                <div class="welcome-illustration">
                    <div class="illustration-circle"></div>
                    <i class="fas fa-rocket"></i>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card glass">
                    <div class="stat-icon blue">
                        <i class="fas fa-key"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value">Û²</span>
                        <span class="stat-label" data-i18n="dashboard.activeLicenses">Ù„Ø§ÛŒØ³Ù†Ø³ ÙØ¹Ø§Ù„</span>
                    </div>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i>
                        +Û±
                    </div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon green">
                        <i class="fas fa-download"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value">Ûµ</span>
                        <span class="stat-label" data-i18n="dashboard.downloads">Ø¯Ø§Ù†Ù„ÙˆØ¯</span>
                    </div>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i>
                        +Û²
                    </div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon orange">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value">Û²Û¸</span>
                        <span class="stat-label" data-i18n="dashboard.daysRemaining">Ø±ÙˆØ² Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡</span>
                    </div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon purple">
                        <i class="fas fa-headset"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value">Û±</span>
                        <span class="stat-label" data-i18n="dashboard.openTickets">ØªÛŒÚ©Øª Ø¨Ø§Ø²</span>
                    </div>
                </div>
            </div>

            <!-- Main Grid -->
            <div class="dashboard-grid">
                <!-- System Check & Install Section (NEW) -->
                <div class="card glass system-check-card" style="grid-column: 1 / -1;">
                    <div class="card-header">
                        <h3><i class="fas fa-stethoscope"></i> <span data-i18n="dashboard.systemCheck">ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ùˆ Ù†ØµØ¨ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</span></h3>
                        <span class="section-badge" id="systemStatus" data-i18n="dashboard.readyToTest">Ø¢Ù…Ø§Ø¯Ù‡ ØªØ³Øª</span>
                    </div>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;" data-i18n="dashboard.systemCheckDesc">
                        Ù‚Ø¨Ù„ Ø§Ø² Ù†ØµØ¨ OdooØŒ Ø³ÛŒØ³ØªÙ… Ø´Ù…Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ø±Ø³Ù…ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ù†ØµØ¨ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.
                    </p>
                    <div class="system-check-grid" id="systemCheckGrid">
                        <div class="check-item" data-check="os">
                            <div class="check-icon"><i class="fas fa-desktop"></i></div>
                            <div class="check-info">
                                <h4>Ø³ÛŒØ³ØªÙ… Ø¹Ø§Ù…Ù„</h4>
                                <p>Windows 10/11 64-bit</p>
                            </div>
                            <span class="check-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                        <div class="check-item" data-check="python">
                            <div class="check-icon"><i class="fab fa-python"></i></div>
                            <div class="check-info">
                                <h4>Python 3.11</h4>
                                <p>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² python.org</p>
                            </div>
                            <span class="check-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                        <div class="check-item" data-check="postgresql">
                            <div class="check-icon"><i class="fas fa-database"></i></div>
                            <div class="check-info">
                                <h4>PostgreSQL 16</h4>
                                <p>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² postgresql.org</p>
                            </div>
                            <span class="check-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                        <div class="check-item" data-check="git">
                            <div class="check-icon"><i class="fab fa-git-alt"></i></div>
                            <div class="check-info">
                                <h4>Git</h4>
                                <p>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² git-scm.com</p>
                            </div>
                            <span class="check-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                        <div class="check-item" data-check="nodejs">
                            <div class="check-icon"><i class="fab fa-node-js"></i></div>
                            <div class="check-info">
                                <h4>Node.js LTS</h4>
                                <p>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² nodejs.org</p>
                            </div>
                            <span class="check-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                        <div class="check-item" data-check="vcredist">
                            <div class="check-icon"><i class="fas fa-cogs"></i></div>
                            <div class="check-info">
                                <h4>VC++ Redistributable</h4>
                                <p>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² microsoft.com</p>
                            </div>
                            <span class="check-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</span>
                        </div>
                    </div>
                    <div class="action-buttons" style="margin-top: 24px; display: flex; gap: 12px; justify-content: center;">
                        <button class="btn btn-primary btn-glow" id="startSystemCheck">
                            <i class="fas fa-search"></i>
                            <span data-i18n="dashboard.startSystemCheck">Ø´Ø±ÙˆØ¹ Ø¨Ø±Ø±Ø³ÛŒ Ø³ÛŒØ³ØªÙ…</span>
                        </button>
                        <button class="btn btn-outline" id="installMissing" style="display: none;">
                            <i class="fas fa-download"></i>
                            <span data-i18n="dashboard.installMissing">Ù†ØµØ¨ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</span>
                        </button>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card glass quick-actions">
                    <div class="card-header">
                        <h3><i class="fas fa-bolt"></i> <span data-i18n="dashboard.quickAccess">Ø¯Ø³ØªØ±Ø³ÛŒ Ø³Ø±ÛŒØ¹</span></h3>
                    </div>
                    <div class="actions-grid">
                        <a href="#downloads" class="action-btn">
                            <div class="action-icon blue">
                                <i class="fas fa-download"></i>
                            </div>
                            <span data-i18n="dashboard.downloadInstaller">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†ØµØ§Ø¨</span>
                        </a>
                        <a href="#licenses" class="action-btn">
                            <div class="action-icon green">
                                <i class="fas fa-plus"></i>
                            </div>
                            <span data-i18n="dashboard.buyLicense">Ø®Ø±ÛŒØ¯ Ù„Ø§ÛŒØ³Ù†Ø³</span>
                        </a>
                        <a href="#" class="action-btn disabled-link" aria-disabled="true" tabindex="-1" title="Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯">
                            <div class="action-icon orange">
                                <i class="fas fa-comment-dots"></i>
                            </div>
                            <span data-i18n="dashboard.sendTicket">Ø§Ø±Ø³Ø§Ù„ ØªÛŒÚ©Øª</span>
                        </a>
                        <a href="#" class="action-btn">
                            <div class="action-icon purple">
                                <i class="fas fa-book"></i>
                            </div>
                            <span data-i18n="dashboard.documentation">Ù…Ø³ØªÙ†Ø¯Ø§Øª</span>
                        </a>
                    </div>
                </div>

                <!-- Active Licenses -->
                <div class="card glass licenses-card" id="licenses">
                    <div class="card-header">
                        <h3><i class="fas fa-key"></i> <span data-i18n="dashboard.activeLicensesTitle">Ù„Ø§ÛŒØ³Ù†Ø³â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„</span></h3>
                        <a href="#licenses" class="card-link" data-i18n="dashboard.viewAll">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡</a>
                    </div>
                    <div class="licenses-list">
                        <div class="license-item">
                            <div class="license-info">
                                <div class="license-icon pro">
                                    <i class="fas fa-gem"></i>
                                </div>
                                <div class="license-details">
                                    <strong>Ù¾Ù„Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</strong>
                                    <span>XXXX-XXXX-XXXX-1234</span>
                                </div>
                            </div>
                            <div class="license-status">
                                <span class="status-badge active">ÙØ¹Ø§Ù„</span>
                                <span class="expiry">Û²Û¸ Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡</span>
                            </div>
                            <div class="license-actions">
                                <button class="icon-btn" title="Ú©Ù¾ÛŒ Ú©Ù„ÛŒØ¯">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="icon-btn" title="Ø¬Ø²Ø¦ÛŒØ§Øª">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                        </div>
                        <div class="license-item">
                            <div class="license-info">
                                <div class="license-icon starter">
                                    <i class="fas fa-seedling"></i>
                                </div>
                                <div class="license-details">
                                    <strong>Ù¾Ù„Ù† Ø±Ø§ÛŒÚ¯Ø§Ù†</strong>
                                    <span>XXXX-XXXX-XXXX-5678</span>
                                </div>
                            </div>
                            <div class="license-status">
                                <span class="status-badge active">ÙØ¹Ø§Ù„</span>
                                <span class="expiry">Ø¨Ø¯ÙˆÙ† Ø§Ù†Ù‚Ø¶Ø§</span>
                            </div>
                            <div class="license-actions">
                                <button class="icon-btn" title="Ú©Ù¾ÛŒ Ú©Ù„ÛŒØ¯">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="icon-btn" title="Ø§Ø±ØªÙ‚Ø§">
                                    <i class="fas fa-arrow-up"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Admin Panel (Embedded) -->
                <div class="card glass" id="admin" style="display: none; padding: 0; overflow: hidden;">
                    <div class="card-header" style="padding: 18px 18px 0 18px; margin-bottom: 12px;">
                        <h3><i class="fas fa-shield-alt"></i> Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h3>
                        <a href="#" class="card-link" id="closeAdminPanel">Ø¨Ø³ØªÙ†</a>
                    </div>
                    <div style="padding: 0 18px 18px 18px;">
                        <iframe
                            id="adminPanelFrame"
                            title="Admin Panel"
                            src="admin.html"
                            style="width: 100%; height: 75vh; border: 0; border-radius: 14px; background: transparent;"
                            loading="lazy"
                        ></iframe>
                    </div>
                </div>

                <!-- Download Section -->
                <div class="card glass download-card" id="downloads">
                    <div class="card-header">
                        <h3><i class="fas fa-download"></i> <span data-i18n="dashboard.downloadInstaller">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†ØµØ§Ø¨</span></h3>
                    </div>
                    <div class="download-content">
                        <div class="download-info">
                            <div class="download-icon">
                                <i class="fas fa-cube"></i>
                            </div>
                            <div class="download-details">
                                <strong>OdooMaster Installer v2.0</strong>
                                <span>Windows 64-bit â€¢ 520 MB</span>
                            </div>
                        </div>
                        <div class="download-meta">
                            <div class="meta-item">
                                <i class="fas fa-calendar"></i>
                                <span data-i18n="dashboard.lastUpdate">Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ:</span> 2025/01/05
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-code-branch"></i>
                                Odoo 19 Community
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block btn-glow download-btn" id="downloadBtn">
                            <i class="fas fa-download"></i>
                            <span data-i18n="dashboard.downloadInstaller">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†ØµØ§Ø¨</span>
                        </button>
                        <div class="download-progress" id="downloadProgress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                            <span class="progress-text" data-i18n="dashboard.preparing">Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ...</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card glass activity-card">
                    <div class="card-header">
                        <h3><i class="fas fa-history"></i> <span data-i18n="dashboard.recentActivity">ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ÛŒØ±</span></h3>
                    </div>
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="activity-icon green">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Ù„Ø§ÛŒØ³Ù†Ø³ ÙØ¹Ø§Ù„ Ø´Ø¯</strong>
                                <span>Ù¾Ù„Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙØ¹Ø§Ù„ Ø´Ø¯</span>
                            </div>
                            <span class="activity-time">Û² Ø³Ø§Ø¹Øª Ù¾ÛŒØ´</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon blue">
                                <i class="fas fa-download"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†ØµØ§Ø¨</strong>
                                <span>Ù†Ø³Ø®Ù‡ Û².Û° Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯</span>
                            </div>
                            <span class="activity-time">Ø¯ÛŒØ±ÙˆØ²</span>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon orange">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="activity-content">
                                <strong>Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚</strong>
                                <span>Û´Û¹Û°,Û°Û°Û° ØªÙˆÙ…Ø§Ù†</span>
                            </div>
                            <span class="activity-time">Û³ Ø±ÙˆØ² Ù¾ÛŒØ´</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gamification Section -->
            <div class="gamification-section">
                <div class="card glass achievements-card">
                    <div class="card-header">
                        <h3><i class="fas fa-trophy"></i> <span data-i18n="dashboard.achievements">Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§</span></h3>
                        <span class="achievement-count">3/12</span>
                    </div>
                    <div class="achievements-grid">
                        <div class="achievement unlocked">
                            <div class="achievement-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <span data-i18n="dashboard.firstStep">Ø§ÙˆÙ„ÛŒÙ† Ù‚Ø¯Ù…</span>
                        </div>
                        <div class="achievement unlocked">
                            <div class="achievement-icon">
                                <i class="fas fa-download"></i>
                            </div>
                            <span data-i18n="dashboard.firstDownload">Ø§ÙˆÙ„ÛŒÙ† Ø¯Ø§Ù†Ù„ÙˆØ¯</span>
                        </div>
                        <div class="achievement unlocked">
                            <div class="achievement-icon">
                                <i class="fas fa-key"></i>
                            </div>
                            <span data-i18n="dashboard.licenseHolder">Ù„Ø§ÛŒØ³Ù†Ø³â€ŒØ¯Ø§Ø±</span>
                        </div>
                        <div class="achievement locked">
                            <div class="achievement-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <span>VIP</span>
                        </div>
                        <div class="achievement locked">
                            <div class="achievement-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <span data-i18n="dashboard.referrer">Ù…Ø¹Ø±Ù</span>
                        </div>
                        <div class="achievement locked">
                            <div class="achievement-icon">
                                <i class="fas fa-crown"></i>
                            </div>
                            <span data-i18n="dashboard.legendary">Ø§ÙØ³Ø§Ù†Ù‡â€ŒØ§ÛŒ</span>
                        </div>
                    </div>
                </div>

                <div class="card glass level-card">
                    <div class="level-header">
                        <div class="level-badge">
                            <i class="fas fa-medal"></i>
                            <span><span data-i18n="dashboard.level">Ø³Ø·Ø­</span> 3</span>
                        </div>
                        <div class="xp-info">
                            <strong>750 XP</strong>
                            <span><span data-i18n="dashboard.toNextLevel">ØªØ§ Ø³Ø·Ø­ Ø¨Ø¹Ø¯ÛŒ:</span> 250 XP</span>
                        </div>
                    </div>
                    <div class="level-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 75%"></div>
                        </div>
                    </div>
                    <div class="level-rewards">
                        <span data-i18n="dashboard.nextLevelReward">Ù¾Ø§Ø¯Ø§Ø´ Ø³Ø·Ø­ Ø¨Ø¹Ø¯ÛŒ:</span>
                        <div class="reward-preview">
                            <i class="fas fa-gift"></i>
                            <span data-i18n="dashboard.discount10">10% ØªØ®ÙÛŒÙ Ø®Ø±ÛŒØ¯ Ø¨Ø¹Ø¯ÛŒ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Notification Panel -->
    <div class="notification-panel" id="notifPanel">
        <div class="notif-header">
            <h4 data-i18n="dashboard.notifications">Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§</h4>
            <button class="mark-read" data-i18n="dashboard.markAllRead">Ù‡Ù…Ù‡ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯</button>
        </div>
        <div class="notif-list">
            <div class="notif-item unread">
                <div class="notif-icon green">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="notif-content">
                    <strong>Ù†ØµØ¨ Ù…ÙˆÙÙ‚!</strong>
                    <p>Odoo Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù†ØµØ¨ Ø´Ø¯</p>
                    <span class="notif-time">Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡ Ù¾ÛŒØ´</span>
                </div>
            </div>
            <div class="notif-item unread">
                <div class="notif-icon blue">
                    <i class="fas fa-gift"></i>
                </div>
                <div class="notif-content">
                    <strong>Ù‡Ø¯ÛŒÙ‡ ÙˆÛŒÚ˜Ù‡!</strong>
                    <p>Û· Ø±ÙˆØ² Ø§Ø´ØªØ±Ø§Ú© Ø±Ø§ÛŒÚ¯Ø§Ù† ÙØ¹Ø§Ù„ Ø´Ø¯</p>
                    <span class="notif-time">Û± Ø³Ø§Ø¹Øª Ù¾ÛŒØ´</span>
                </div>
            </div>
            <div class="notif-item">
                <div class="notif-icon orange">
                    <i class="fas fa-sync"></i>
                </div>
                <div class="notif-content">
                    <strong>Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¬Ø¯ÛŒØ¯</strong>
                    <p>Ù†Ø³Ø®Ù‡ Û².Û± Ù…Ù†ØªØ´Ø± Ø´Ø¯</p>
                    <span class="notif-time">Ø¯ÛŒØ±ÙˆØ²</span>
                </div>
            </div>
        </div>
    </div>

    <script src="js/i18n.js"></script>
    <script src="js/api.js"></script>
    <script src="js/main.js"></script>
    <script src="js/installer.js"></script>
    <script src="js/dashboard.js"></script>
    <script>
        // Load real user data from API
        (async function loadDashboardData() {
            const token = localStorage.getItem('authToken');
            if (!token) {
                // Not logged in - redirect to login
                window.location.href = 'login.html?redirect=dashboard.html';
                return;
            }

            try {
                const res = await API.getMe();
                if (!res || !res.user) {
                    localStorage.removeItem('authToken');
                    window.location.href = 'login.html?redirect=dashboard.html';
                    return;
                }

                const user = res.user;
                const licenses = res.licenses || [];
                const stats = res.stats || {};

                // Update user name in welcome banner
                const welcomeTitle = document.querySelector('.welcome-content h1');
                if (welcomeTitle) {
                    welcomeTitle.innerHTML = `Ø³Ù„Ø§Ù…ØŒ <span class="gradient-text">${user.name || 'Ú©Ø§Ø±Ø¨Ø±'}</span> ğŸ‘‹`;
                }

                // Update sidebar user card
                const userCard = document.querySelector('.user-card');
                if (userCard) {
                    const avatar = userCard.querySelector('.user-avatar img');
                    const nameEl = userCard.querySelector('.user-info strong');
                    const planEl = userCard.querySelector('.user-info span');
                    
                    if (avatar) avatar.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name || 'User')}&background=714B67&color=fff`;
                    if (nameEl) nameEl.textContent = user.name || 'Ú©Ø§Ø±Ø¨Ø±';
                    
                    // Find active plan
                    const activeLicense = licenses.find(l => l.status === 'active');
                    if (planEl) planEl.textContent = activeLicense ? (activeLicense.plan || 'Ù¾Ù„Ù† Ø±Ø§ÛŒÚ¯Ø§Ù†') : 'Ø¨Ø¯ÙˆÙ† Ù¾Ù„Ù†';
                }

                // Update stats cards
                const statCards = document.querySelectorAll('.stat-card');
                if (statCards.length >= 4) {
                    // Active licenses
                    const licenseValue = statCards[0].querySelector('.stat-value');
                    if (licenseValue) licenseValue.textContent = toPersianNum(stats.active_licenses || 0);

                    // Downloads
                    const downloadValue = statCards[1].querySelector('.stat-value');
                    if (downloadValue) downloadValue.textContent = toPersianNum(stats.total_downloads || 0);

                    // Days remaining (find soonest expiring license)
                    const daysValue = statCards[2].querySelector('.stat-value');
                    if (daysValue) {
                        const activeLicenses = licenses.filter(l => l.status === 'active' && l.expires_at);
                        let minDays = null;
                        activeLicenses.forEach(l => {
                            const exp = new Date(l.expires_at);
                            const now = new Date();
                            const days = Math.ceil((exp - now) / (1000 * 60 * 60 * 24));
                            if (days > 0 && (minDays === null || days < minDays)) minDays = days;
                        });
                        daysValue.textContent = minDays !== null ? toPersianNum(minDays) : 'â€”';
                    }

                    // Open tickets (placeholder - would need tickets API)
                    const ticketValue = statCards[3].querySelector('.stat-value');
                    if (ticketValue) ticketValue.textContent = toPersianNum(0);
                }

                // Update licenses list
                const licensesList = document.querySelector('.licenses-list');
                if (licensesList && licenses.length > 0) {
                    licensesList.innerHTML = licenses.slice(0, 3).map(lic => {
                        const isPro = (lic.plan || '').toLowerCase().includes('pro') || (lic.plan || '').includes('Ø­Ø±ÙÙ‡');
                        const iconClass = isPro ? 'pro' : 'starter';
                        const icon = isPro ? 'fa-gem' : 'fa-seedling';
                        const planName = lic.plan || 'Ù¾Ù„Ù† Ø±Ø§ÛŒÚ¯Ø§Ù†';
                        const keyDisplay = lic.key ? lic.key.substring(0, 4) + '-XXXX-XXXX-' + lic.key.slice(-4) : 'â€”';
                        
                        let expiryText = 'Ø¨Ø¯ÙˆÙ† Ø§Ù†Ù‚Ø¶Ø§';
                        if (lic.expires_at) {
                            const exp = new Date(lic.expires_at);
                            const now = new Date();
                            const days = Math.ceil((exp - now) / (1000 * 60 * 60 * 24));
                            expiryText = days > 0 ? toPersianNum(days) + ' Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡' : 'Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡';
                        }

                        return `
                            <div class="license-item">
                                <div class="license-info">
                                    <div class="license-icon ${iconClass}">
                                        <i class="fas ${icon}"></i>
                                    </div>
                                    <div class="license-details">
                                        <strong>${planName}</strong>
                                        <span>${keyDisplay}</span>
                                    </div>
                                </div>
                                <div class="license-status">
                                    <span class="status-badge ${lic.status === 'active' ? 'active' : 'expired'}">${lic.status === 'active' ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ±ÙØ¹Ø§Ù„'}</span>
                                    <span class="expiry">${expiryText}</span>
                                </div>
                                <div class="license-actions">
                                    <button class="icon-btn" title="Ú©Ù¾ÛŒ Ú©Ù„ÛŒØ¯" onclick="navigator.clipboard.writeText('${lic.key || ''}')">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="icon-btn" title="Ø¬Ø²Ø¦ÛŒØ§Øª">
                                        <i class="fas fa-info-circle"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else if (licensesList) {
                    licensesList.innerHTML = '<p style="text-align:center; color: var(--text-secondary); padding: 20px;">Ù‡ÛŒÚ† Ù„Ø§ÛŒØ³Ù†Ø³ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯. <a href="payment.html">Ø®Ø±ÛŒØ¯ Ú©Ù†ÛŒØ¯</a></p>';
                }

                // Update sidebar license badge
                const licenseBadge = document.querySelector('.nav-item[href="#licenses"] .nav-badge') || document.querySelector('.nav-item[href="licenses.html"] .nav-badge');
                if (licenseBadge) licenseBadge.textContent = toPersianNum(stats.active_licenses || 0);

                // Update XP/Level card
                const levelBadge = document.querySelector('.level-badge span');
                if (levelBadge) levelBadge.textContent = 'Ø³Ø·Ø­ ' + toPersianNum(user.level || 1);

                const xpInfo = document.querySelector('.xp-info strong');
                if (xpInfo) xpInfo.textContent = toPersianNum(user.xp || 0) + ' XP';

            } catch (err) {
                console.error('Failed to load dashboard data:', err);
            }
        })();

        function toPersianNum(num) {
            const persianDigits = 'Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹';
            return String(num).replace(/\d/g, d => persianDigits[d]);
        }

        // System Check Integration
        document.addEventListener('DOMContentLoaded', function() {
            const checkBtn = document.getElementById('startSystemCheck');
            const installBtn = document.getElementById('installMissing');
            const statusBadge = document.getElementById('systemStatus');
            
            if (checkBtn) {
                checkBtn.addEventListener('click', async function() {
                    checkBtn.disabled = true;
                    checkBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...';
                    statusBadge.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...';
                    statusBadge.style.background = 'var(--primary)';
                    statusBadge.style.color = 'white';
                    
                    // Run system check
                    await OnlineInstaller.checkSystem();
                    
                    // Update UI based on results
                    const results = OnlineInstaller.state.checkResults;
                    const grid = document.getElementById('systemCheckGrid');
                    
                    for (const [name, result] of Object.entries(results)) {
                        const item = grid.querySelector(`[data-check="${name}"]`);
                        if (item) {
                            item.classList.remove('checking', 'success', 'warning', 'error');
                            item.classList.add(result.status);
                            item.querySelector('.check-status').textContent = 
                                result.installed ? result.version : (result.message || 'Ù†ØµØ¨ Ù†Ø´Ø¯Ù‡');
                        }
                    }
                    
                    // Show install button if needed
                    if (OnlineInstaller.state.installQueue.length > 0) {
                        installBtn.style.display = 'inline-flex';
                        statusBadge.textContent = `${OnlineInstaller.state.installQueue.length} Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù†ØµØ¨`;
                        statusBadge.style.background = '#ff5f57';
                    } else {
                        statusBadge.textContent = 'Ø¢Ù…Ø§Ø¯Ù‡ Ù†ØµØ¨ Odoo âœ“';
                        statusBadge.style.background = '#28ca42';
                    }
                    
                    checkBtn.disabled = false;
                    checkBtn.innerHTML = '<i class="fas fa-redo"></i> Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø¬Ø¯Ø¯';
                });
            }
            
            if (installBtn) {
                installBtn.addEventListener('click', function() {
                    // Show download links for missing items
                    const queue = OnlineInstaller.state.installQueue;
                    let message = 'Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø±Ø³Ù…ÛŒ:\\n\\n';
                    
                    queue.forEach(item => {
                        message += `${item.name} (${item.size}):\\n${item.url}\\n\\n`;
                    });
                    
                    message += 'Ù¾Ø³ Ø§Ø² Ù†ØµØ¨ØŒ Ø¯Ú©Ù…Ù‡ "Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø¬Ø¯Ø¯" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.';
                    
                    // Open first download
                    if (queue.length > 0) {
                        window.open(queue[0].url, '_blank');
                    }
                    
                    alert(message);
                });
            }
        });
    </script>
</body>
</html>
